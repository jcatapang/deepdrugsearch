## Deep Drug Search

Welcome to the project page of Deep Drug Search. Deep Drug Search (DDS) is a drug generation software that utilizes the power of deep learning to generate new ligands from existing drugs. Through the deep learning process, the drugs generated inherit the potency and efficacy of the existing drugs.

All of this is possible through variational autoencoders. A variational autoencoder is an autoencoder whose encodings distribution is regularised during the training in order to ensure that its latent space has good properties allowing us to generate some new data. An autoencoder is a type of artificial neural network used to learn efficient data codings in an unsupervised manner. The aim of an autoencoder is to learn a representation for a set of data, typically for dimensionality reduction, by training the network to ignore noise.

The software was built on the code utilized by Jasper Kyle Catapang and Dr. Junie B. Billones of the University of the Philippines Manila, on their drug discovery research paper entitled [On the Generation of Novel Ligands for SARS-CoV-2 Protease and ACE2 Receptor via Constrained Graph Variational Autoencoders](https://chemrxiv.org/articles/On_the_Generation_of_Novel_Ligands_for_SARS-CoV-2_Protease_and_ACE2_Receptor_via_Constrained_Graph_Variational_Autoencoders/12011157), which was preprinted on March 24, 2020, and is now being reviewed for journal publication.

## Software Features

Deep Drug Search has two main components for now:
1. Ligand generation
2. Ligand-protein docking

### Ligand generation

Here is the drug generation user interface:
![DDS Generation UI](https://raw.githubusercontent.com/leeseojun17/deepdrugsearch/master/graphics/dds%20ui.JPG "DDS Generation UI")

Ligands are generated by importing a set of input drugs called basis drugs. These are the drugs that the variational autoencoders would be using in the learning or training phase. The software accepts a bulk SMILES file (.smi) as input. The minimum amount of drugs to be considered as input is 100. The drug likeliness or QED is calculated upon importing.

![DDS Import](https://raw.githubusercontent.com/leeseojun17/deepdrugsearch/master/graphics/dds%20import.JPG "DDS Import")

New ligands are generated with a touch of a button! Just select the number of ligands to be generated and let the software do the drug design. The generation number ranges from 5 to 100 with a step value of 5.

![DDS Generating](https://raw.githubusercontent.com/leeseojun17/deepdrugsearch/master/graphics/dds%20gen%20progress.jpg "DDS Generating")

After generating, the SMILES of the new ligands are saved as a CSV file named `drugs.csv` under the `resources/data` directory. It contains the QED and the water-octanol partition coefficient or logP of the drugs (indicating solubility). Please note that the number that you set for generation won't match the number of the actual yield, since not all of the designs of the generated ligands conform to actual chemical structures. The 2D representations of these ligands are saved under the directory named `visualization`.

![DDS Generated](https://raw.githubusercontent.com/leeseojun17/deepdrugsearch/master/graphics/dds%20gen%20finished.JPG "DDS Generated")

You also have the options to save the conforming generated ligands as SDF files or as PDBQT files. PDBQT files are required for the docking module of DDS. The SDF files would be saved under the `resources/data` directory, while the PDBQT files would be saved under `pdbqt`.

### Ligand-protein docking

Here is the docking interface of the Deep Drug Search software:
![DDS Dock](https://raw.githubusercontent.com/leeseojun17/deepdrugsearch/master/graphics/dds%20dock.JPG "DDS Dock")

To add ligands to be docked, just click on the + button, and to delete ligands from the queue, click on the - button. To import a protein, click on the Select Protein button. These two require .pdbqt files in order to work. When these two are set up properly, it would enable the AUTODOCK button.

Please fill in the center x, y, and z and the dimension x, y, and z first before clicking the AUTODOCK button. The center and dimension refer to the grid box where the docking procedure would perform different conformations on. The dimension is in Angstroms. Any input error on the center and dimension fields would raise an error and would prompt you to review those fields and try again.

![DDS Dock Error](https://raw.githubusercontent.com/leeseojun17/deepdrugsearch/master/graphics/dds%20dock%20error.JPG  "DDS Dock Error")

If your inputs are properly formatted, the AUTODOCK button would launch Autodock Vina using the parameters you have set.

![DDS Docking](https://raw.githubusercontent.com/leeseojun17/deepdrugsearch/master/graphics/dds%20docking.JPG  "DDS Docking")

## System Requirements

To run Deep Drug Search without any issue, here are the minimum specifications:
* Operating system: Windows 10
* RAM: 8 GB
* CPU: Intel core i5 or AMD Ryzen 7
* Free space: 2.3 GB 

Support for the Mac OS X version is still under development.

## In-development

Here are the various features and updates to be expected in the months to come:
1. Support for Mac OS X
2. Import basis drugs via bulk SDF file and not just via bulk SMILES file
3. Include the calculation of drug toxicity in the `drugs.csv` generated for the newly generated ligands

## Support

Having trouble with Deep Drug Search? Please e-mail Jasper Kyle Catapang through [university e-mail address](jcatapang@up.edu.ph) or his [Github e-mail address](leeseojun17@naver.com).
